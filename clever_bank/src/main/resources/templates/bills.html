<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;500;600&display=swap" rel="stylesheet">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="stylesheet" type="text/css" href="/css/bills.css">
    <link rel="stylesheet" type="text/css" href="/css/nav-side-bar.css">
    <title>Bills Management - Clever Bank</title>
    <link rel="icon" href="/images/building-columns-solid.svg" type="images/png">
</head>
<body>
<div class="nav-bar">
    <div class="side-bar-container">
        <nav>
            <div class="side_navbar">
                <div class="clever-bank-nav-bar">
                    <div class="clever-bank-nav-bar-name">Clever Bank</div>
                </div>
                <div class="func-block">
                    <a href="/home" class="active">
                        <p>Dashboard</p>
                        <svg class="w-6 h-6 text-gray-800 dark:text-white" aria-hidden="true"
                             xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24">
                            <path stroke="currentColor" stroke-linecap="round" stroke-width="2"
                                  d="M5 7h14M5 12h14M5 17h14"></path>
                        </svg>
                    </a>
                    <a class="special-gold" href="/subscriptions">
                        <p>Upgrade</p>
                        <svg class="w-6 h-6 text-gray-800 dark:text-white" aria-hidden="true"
                             xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor"
                             viewBox="0 0 24 24">
                            <path fill-rule="evenodd"
                                  d="M12 2c-.791 0-1.55.314-2.11.874l-.893.893a.985.985 0 0 1-.696.288H7.04A2.984 2.984 0 0 0 4.055 7.04v1.262a.986.986 0 0 1-.288.696l-.893.893a2.984 2.984 0 0 0 0 4.22l.893.893a.985.985 0 0 1 .288.696v1.262a2.984 2.984 0 0 0 2.984 2.984h1.262c.261 0 .512.104.696.288l.893.893a2.984 2.984 0 0 0 4.22 0l.893-.893a.985.985 0 0 1 .696-.288h1.262a2.984 2.984 0 0 0 2.984-2.984V15.7c0-.261.104-.512.288-.696l.893-.893a2.984 2.984 0 0 0 0-4.22l-.893-.893a.985.985 0 0 1-.288-.696V7.04a2.984 2.984 0 0 0-2.984-2.984h-1.262a.985.985 0 0 1-.696-.288l-.893-.893A2.984 2.984 0 0 0 12 2Zm3.683 7.73a1 1 0 1 0-1.414-1.413l-4.253 4.253-1.277-1.277a1 1 0 0 0-1.415 1.414l1.985 1.984a1 1 0 0 0 1.414 0l4.96-4.96Z"
                                  clip-rule="evenodd"></path>
                        </svg>
                    </a>
                </div>
                <div class="func-block">
                    <span>Quick Link</span>
                    <a href="/transfers">
                        <p>Transfers</p>
                        <svg class="w-6 h-6 text-gray-800 dark:text-white" aria-hidden="true"
                             xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24">
                            <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                  d="m16 10 3-3m0 0-3-3m3 3H5v3m3 4-3 3m0 0 3 3m-3-3h14v-3"></path>
                        </svg>
                    </a>
                    <a href="/pockets">
                        <p>Pocket</p>
                        <svg class="w-6 h-6 text-gray-800 dark:text-white" aria-hidden="true"
                             xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor"
                             viewBox="0 0 24 24">
                            <path fill-rule="evenodd"
                                  d="M12 14a3 3 0 0 1 3-3h4a2 2 0 0 1 2 2v2a2 2 0 0 1-2 2h-4a3 3 0 0 1-3-3Zm3-1a1 1 0 1 0 0 2h4v-2h-4Z"
                                  clip-rule="evenodd"></path>
                            <path fill-rule="evenodd"
                                  d="M12.293 3.293a1 1 0 0 1 1.414 0L16.414 6h-2.828l-1.293-1.293a1 1 0 0 1 0-1.414ZM12.414 6 9.707 3.293a1 1 0 0 0-1.414 0L5.586 6h6.828ZM4.586 7l-.056.055A2 2 0 0 0 3 9v10a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2h-4a5 5 0 0 1 0-10h4a2 2 0 0 0-1.53-1.945L17.414 7H4.586Z"
                                  clip-rule="evenodd"></path>
                        </svg>
                    </a>
                    <a href="/bills">
                        <p>Bills</p>
                        <svg class="w-6 h-6 text-gray-800 dark:text-white" aria-hidden="true"
                             xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor"
                             viewBox="0 0 24 24">
                            <path fill-rule="evenodd"
                                  d="M9 2.221V7H4.221a2 2 0 0 1 .365-.5L8.5 2.586A2 2 0 0 1 9 2.221ZM11 2v5a2 2 0 0 1-2 2H4a2 2 0 0 0-2 2v7a2 2 0 0 0 2 2 2 2 0 0 0 2 2h12a2 2 0 0 0 2-2 2 2 0 0 0 2-2v-7a2 2 0 0 0-2-2V4a2 2 0 0 0-2-2h-5Zm-6 9a1 1 0 0 0-1 1v5a1 1 0 1 0 2 0v-1h.5a2.5 2.5 0 0 0 0-5H5Zm1.5 3H6v-1h.5a.5.5 0 0 1 0 1Zm4.5-3a1 1 0 0 0-1 1v5a1 1 0 0 0 1 1h1.376A2.626 2.626 0 0 0 15 15.375v-1.75A2.626 2.626 0 0 0 12.375 11H11Zm1 5v-3h.375a.626.626 0 0 1 .625.625v1.75a.626.626 0 0 1-.626.625H12Zm5-5a1 1 0 0 0-1 1v5a1 1 0 1 0 2 0v-1h1a1 1 0 1 0 0-2h-1v-1h1a1 1 0 1 0 0-2h-2Z"
                                  clip-rule="evenodd"></path>
                        </svg>
                    </a>
                    <a href="/transactions">
                        <p>Transactions</p>
                        <svg class="w-6 h-6 text-gray-800 dark:text-white" aria-hidden="true"
                             xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24">
                            <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                  d="M8 20V7m0 13-4-4m4 4 4-4m4-12v13m0-13 4 4m-4-4-4 4"></path>
                        </svg>
                    </a>
                    <a href="/cards">
                        <p>Cards</p>
                        <svg class="w-6 h-6 text-gray-800 dark:text-white" aria-hidden="true"
                             xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor"
                             viewBox="0 0 24 24">
                            <path fill-rule="evenodd"
                                  d="M4 4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2H4Zm16 7H4v7h16v-7ZM6 14a1 1 0 0 1 1-1h2a1 1 0 1 1 0 2H7a1 1 0 0 1-1-1Zm5 0a1 1 0 0 1 1-1h6a1 1 0 1 1 0 2h-6a1 1 0 0 1-1-1Z"
                                  clip-rule="evenodd"></path>
                        </svg>
                    </a>
                    <a href="/notices">
                        <p>Notices</p>
                        <svg class="w-6 h-6 text-gray-800 dark:text-white" aria-hidden="true"
                             xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor"
                             viewBox="0 0 24 24">
                            <path d="M17.133 12.632v-1.8a5.406 5.406 0 0 0-4.154-5.262.955.955 0 0 0 .021-.106V3.1a1 1 0 0 0-2 0v2.364a.955.955 0 0 0 .021.106 5.406 5.406 0 0 0-4.154 5.262v1.8C6.867 15.018 5 15.614 5 16.807 5 17.4 5 18 5.538 18h12.924C19 18 19 17.4 19 16.807c0-1.193-1.867-1.789-1.867-4.175ZM8.823 19a3.453 3.453 0 0 0 6.354 0H8.823Z"></path>
                        </svg>
                    </a>
                </div>
                <div class="func-block">
                    <span>Utility</span>
                    <a href="/subscriptions/history">
                        <p> History</p>
                        <svg class="w-6 h-6 text-gray-800 dark:text-white" aria-hidden="true"
                             xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24">
                            <path stroke="currentColor" stroke-linecap="round" stroke-width="2"
                                  d="M12 6h.01M12 12h.01M12 18h.01"></path>
                        </svg>
                    </a>
                </div>
                <div class="func-block admin-func-block">
                    <span>Admin</span>
                    <a href="/customers">
                        <p>Customer</p>
                        <svg class="w-6 h-6 text-gray-800 dark:text-white" aria-hidden="true"
                             xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24">
                            <path stroke="currentColor" stroke-linecap="round" stroke-width="2"
                                  d="M12 6h.01M12 12h.01M12 18h.01"></path>
                        </svg>
                    </a>
                </div>
                <div class="func-block">
                    <a class="logout" href="/logout">
                        <p>Logout</p>
                        <svg class="w-6 h-6 text-gray-800 dark:text-white" aria-hidden="true"
                             xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24">
                            <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                  d="M20 12H8m12 0-4 4m4-4-4-4M9 4H7a3 3 0 0 0-3 3v10a3 3 0 0 0 3 3h2"></path>
                        </svg>
                    </a>
                </div>
            </div>
        </nav>
    </div>
</div>
<main>
    <section class="section full-height">

<!--        <div class="container">-->
<!--            <a href="/home" class="logo-big">-->
<!--                <img src="/images/CLEVER%20BANK%20TEXT%20HORIZONTAL.png" alt="Clever Bank Logo">-->
<!--            </a>-->
<!--        </div>-->

        <!-- Add New Bill Form -->
        <form class="form"
              th:action="@{/bills/add}"
              th:method="POST"
              th:object="${billsRequest}">

            <h3>✨🧾 Add New Bill</h3>

            <label for="billNumber">Bill Number</label>
            <input type="text"
                   placeholder="Enter bill number"
                   id="billNumber"
                   th:field="*{billNumber}" required>

            <p class="alert-warning" th:if="${#fields.hasErrors('billNumber')}" th:errors="*{billNumber}"></p>

            <label for="billCategory">Category</label>
            <select id="billCategory" th:field="*{billCategory}" required>
                <option value="">Select a category</option>
                <option value="INTERNET">Internet</option>
                <option value="TELEPHONE">Telephone</option>
                <option value="ELECTRICITY">Electricity</option>
                <option value="WATER">Water</option>
                <option value="HOUSEMAN">Houseman</option>
            </select>
            <p class="alert-warning" th:if="${#fields.hasErrors('billCategory')}" th:errors="*{billCategory}"></p>

            <label for="amount">Amount</label>
            <input type="number"
                   placeholder="0.00"
                   id="amount"
                   th:field="*{amount}"
                   step="0.01"
                   required>
            <p class="alert-warning" th:if="${#fields.hasErrors('amount')}" th:errors="*{amount}"></p>

            <label for="description">Description (Optional)</label>
            <input type="text"
                   placeholder="Enter description"
                   id="description"
                   th:field="*{description}">
            <p class="alert-warning" th:if="${#fields.hasErrors('description')}" th:errors="*{description}"></p>

<!--            <p class="alert-success" th:if="${successMessage}" th:text="${successMessage}"></p>-->
<!--            <p class="alert-warning" th:if="${errorMessage}" th:text="${errorMessage}"></p>-->

            <button type="submit">Add Bill</button>

            <p class="form-already">View all your bills below or <a href="/home">return to dashboard</a></p>

        </form>

        <!-- Bills List Section -->
        <div class="bills-list-container" >
            <div class="bills-header">
                <h2> 💳💸 Your Bills – Pay Fast and Easy ✅</h2>
                <p class="bills-count">Total: <span th:text="${bills.size()}">0</span> bills</p>
            </div>

            <div class="bills-grid">
                <div class="bill-card" th:each="bill : ${bills}">
                    <div class="bill-card-header">
                        <span class="bill-number" th:text="${bill.billNumber}">BILL-001</span>
                        <span class="category-badge"
                              th:classappend="${#strings.toLowerCase(bill.category)}"
                              th:text="${#strings.capitalize(#strings.toLowerCase(bill.category))}">
                            Internet
                        </span>
                    </div>

                    <div class="bill-card-body">
                        <div class="bill-amount">
                            <span class="currency">$</span>
                            <span class="amount-value" th:text="${#numbers.formatDecimal(bill.amount, 1, 2)}">0.00</span>
                        </div>

                        <p class="bill-description" th:text="${bill.description }">
                            Description
                        </p>

                        <div class="bill-meta">
                            <span class="bill-date">
                                <i class="far fa-calendar-alt"></i>
                                <span th:text="${#temporals.format(bill.createdOn, 'dd MMM YYYY HH:mm',T(java.util.Locale).ENGLISH)}">01 Jan 2025</span>
                            </span>
                            <span class="bill-status"
                                  th:classappend="${bill.status.name() == 'CANCELED' ? 'cancelled' : #strings.toLowerCase(bill.status)}"
                                  th:text="${#strings.capitalize(#strings.toLowerCase(bill.status.name()))}">
                            </span>
                        </div>

                    </div>

                    <div class="bill-card-footer">
                        <div class="bill-actions">
                            <form  th:if="${bill.status.name() != 'PAID'}"
                                    th:action="@{/bills/pay/{id}(id=${bill.id})}" method="post" class="pay-form">
                                <button type="submit"
                                        class="btn-pay"
                                        onclick="return confirm('Are you sure you want to pay this bill?')">
                                    <i class="fas fa-check-circle"></i> Pay
                                </button>
                            </form>



                            <form th:action="@{'/bills/delete/' + ${bill.id}}" method="POST"  class="delete-form">

                                <input type="hidden" name="_method" value="delete" />
                                <button type="submit"
                                        class="btn-delete"
                                        onclick="return confirm('Are you sure you want to delete this bill?')">
                                    <i class="fas fa-trash-alt"></i> Delete
                                </button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Empty State -->
        <div class="empty-state" th:if="${bills == null or bills.isEmpty()}">
            <div class="empty-state-icon">
                <i class="fas fa-file-invoice"></i>
            </div>
            <h3>No Bills Yet</h3>
            <p>Add your first bill using the form above to get started.</p>
        </div>

    </section>
</main>

<th:block th:insert="~{fragments/footer :: footer}"></th:block>

</body>
</html>
