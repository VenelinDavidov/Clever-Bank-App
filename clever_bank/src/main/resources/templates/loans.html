<!doctype html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Loan Applications - Clever Bank</title>
    <link rel="stylesheet" type="text/css" href="/css/loans.css">
    <link rel="stylesheet" type="text/css" href="/css/nav-side-bar.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
<div class="nav-bar">
    <div class="side-bar-container">
        <nav>
            <div class="side_navbar">
                <div class="clever-bank-nav-bar">
                    <div class="clever-bank-nav-bar-name">Clever Bank</div>
                </div>
                <div class="func-block">
                    <a href="/home">
                        <p>Dashboard</p>
                        <svg class="w-6 h-6 text-gray-800 dark:text-white" aria-hidden="true"
                             xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24">
                            <path stroke="currentColor" stroke-linecap="round" stroke-width="2"
                                  d="M5 7h14M5 12h14M5 17h14"></path>
                        </svg>
                    </a>
                    <a class="active special-gold" href="/loans">
                        <p>Loans</p>
                        <svg class="w-6 h-6 text-gray-800 dark:text-white" aria-hidden="true"
                             xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor"
                             viewBox="0 0 24 24">
                            <path fill-rule="evenodd"
                                  d="M12 2c-.791 0-1.55.314-2.11.874l-.893.893a.985.985 0 0 1-.696.288H7.04A2.984 2.984 0 0 0 4.055 7.04v1.262a.986.986 0 0 1-.288.696l-.893.893a2.984 2.984 0 0 0 0 4.22l.893.893a.985.985 0 0 1 .288.696v1.262a2.984 2.984 0 0 0 2.984 2.984h1.262c.261 0 .512.104.696.288l.893.893a2.984 2.984 0 0 0 4.22 0l.893-.893a.985.985 0 0 1-.696-.288h-1.262a.985.985 0 0 0-.696-.288l-.893-.893A2.984 2.984 0 0 0 12 2Zm3.683 7.73a1 1 0 1 0-1.414-1.413l-4.253 4.253-1.277-1.277a1 1 0 0 0-1.415 1.414l1.985 1.984a1 1 0 0 0 1.414 0l4.96-4.96Z"
                                  clip-rule="evenodd"></path>
                        </svg>
                    </a>
                </div>
                <div class="func-block">
                    <span>Quick Link</span>
                    <a href="/transfers">
                        <p>Transfers</p>
                        <svg class="w-6 h-6 text-gray-800 dark:text-white" aria-hidden="true"
                             xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24">
                            <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                  d="m16 10 3-3m0 0-3-3m3 3H5v3m3 4-3 3m0 0 3 3m-3-3h14v-3"></path>
                        </svg>
                    </a>
                    <a href="/pockets">
                        <p>Pocket</p>
                        <svg class="w-6 h-6 text-gray-800 dark:text-white" aria-hidden="true"
                             xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor"
                             viewBox="0 0 24 24">
                            <path fill-rule="evenodd"
                                  d="M12 14a3 3 0 0 1 3-3h4a2 2 0 0 1 2 2v2a2 2 0 0 1-2 2h-4a3 3 0 0 1-3-3Zm3-1a1 1 0 1 0 0 2h4v-2h-4Z"
                                  clip-rule="evenodd"></path>
                            <path fill-rule="evenodd"
                                  d="M12.293 3.293a1 1 0 0 1 1.414 0L16.414 6h-2.828l-1.293-1.293a1 1 0 0 0 0-1.414ZM12.414 6 9.707 3.293a1 1 0 0 0-1.414 0L5.586 6h6.828ZM4.586 7l-.056.055A2 2 0 0 0 3 9v10a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2h-4a5 5 0 0 1 0-10h4a2 2 0 0 0-1.53-1.945L17.414 7H4.586Z"
                                  clip-rule="evenodd"></path>
                        </svg>
                    </a>
                    <a href="/bills">
                        <p>Bills</p>
                        <svg class="w-6 h-6 text-gray-800 dark:text-white" aria-hidden="true"
                             xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor"
                             viewBox="0 0 24 24">
                            <path fill-rule="evenodd"
                                  d="M9 2.221V7H4.221a2 2 0 0 1 .365-.5L8.5 2.586A2 2 0 0 1 9 2.221ZM11 2v5a2 2 0 0 1-2 2H4a2 2 0 0 0-2 2v7a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2 2 2 0 0 0 2-2v-7a2 2 0 0 0-2-2V4a2 2 0 0 0-2-2h-5Zm-6 9a1 1 0 0 0-1 1v5a1 1 0 1 0 2 0v-1h.5a2.5 2.5 0 0 0 0-5H5Zm1.5 3H6v-1h.5a.5.5 0 0 1 0 1Zm4.5-3a1 1 0 0 0-1 1v5a1 1 0 0 0 1 1h1.376A2.626 2.626 0 0 0 15 15.375v-1.75A2.626 2.626 0 0 0 12.375 11H11Zm1 5v-3h.375a.626.626 0 0 1 .625.625v1.75a.626.626 0 0 1-.626.625H12Zm5-5a1 1 0 0 0-1 1v5a1 1 0 0 0 1 1h1a1 1 0 1 0 0-2h-1v-1h1a1 1 0 1 0 0-2h-2Z"
                                  clip-rule="evenodd"></path>
                        </svg>
                    </a>
                    <a href="/transactions">
                        <p>Transactions</p>
                        <svg class="w-6 h-6 text-gray-800 dark:text-white" aria-hidden="true"
                             xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24">
                            <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                  d="M8 20V7m0 13-4-4m4 4 4-4m4-12v13m0-13 4 4m-4-4-4 4"></path>
                        </svg>
                    </a>
                    <a href="/cards">
                        <p>Cards</p>
                        <svg class="w-6 h-6 text-gray-800 dark:text-white" aria-hidden="true"
                             xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor"
                             viewBox="0 0 24 24">
                            <path fill-rule="evenodd"
                                  d="M4 4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2H4Zm16 7H4v7h16v-7ZM6 14a1 1 0 0 1 1-1h2a1 1 0 1 1 0 2H7a1 1 0 0 1-1-1Zm5 0a1 1 0 0 1 1-1h6a1 1 0 1 1 0 2h-6a1 1 0 0 1-1-1Z"
                                  clip-rule="evenodd"></path>
                        </svg>
                    </a>
                    <a href="/notices">
                        <p>Notices</p>
                        <svg class="w-6 h-6 text-gray-800 dark:text-white" aria-hidden="true"
                             xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor"
                             viewBox="0 0 24 24">
                            <path d="M17.133 12.632v-1.8a5.406 5.406 0 0 0-4.154-5.262.955.955 0 0 0 .021-.106V3.1a1 1 0 0 0-2 0v2.364a.955.955 0 0 0 .021.106 5.406 5.406 0 0 0-4.154 5.262v1.8C6.867 15.018 5 15.614 5 16.807 5 17.4 5 18 5.538 18h12.924C19 18 19 17.4 19 16.807c0-1.193-1.867-1.789-1.867-4.175ZM8.823 19a3.453 3.453 0 0 0 6.354 0H8.823Z"></path>
                        </svg>
                    </a>
                </div>
                <div class="func-block">
                    <span>Utility</span>
                    <a href="/contact-us">
                        <p> Contact</p>
                        <svg class="w-6 h-6 text-gray-800 dark:text-white" aria-hidden="true"
                             xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24">
                            <path stroke="currentColor" stroke-linecap="round" stroke-width="2"
                                  d="M12 6h.01M12 12h.01M12 18h.01"></path>
                        </svg>
                    </a>
                </div>
                <div class="func-block admin-func-block" th:if="${customer.getRole().name() == 'ADMIN'}">
                    <span>Admin</span>
                    <a href="/customers">
                        <p>Customer</p>
                        <svg class="w-6 h-6 text-gray-800 dark:text-white" aria-hidden="true"
                             xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24">
                            <path stroke="currentColor" stroke-linecap="round" stroke-width="2"
                                  d="M12 6h.01M12 12h.01M12 18h.01"></path>
                        </svg>
                    </a>
                </div>
                <div class="func-block">
                    <a class="logout" href="/logout">
                        <p>Logout</p>
                        <svg class="w-6 h-6 text-gray-800 dark:text-white" aria-hidden="true"
                             xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24">
                            <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                  d="M20 12H8m12 0-4 4m4 4 4-4m4-12v13m0-13 4 4m-4-4-4 4"></path>
                        </svg>
                    </a>
                </div>
            </div>
        </nav>
    </div>
</div>

<main class="loans-main-content">
    <div class="loans-container">
        <!-- Header Section -->
        <div class="loans-header">
            <div class="header-content">
                <h1 class="page-title">Loan Applications</h1>
                <p class="page-subtitle">Apply for a loan or manage your existing applications</p>
            </div>
        </div>

        <!-- Alert Messages -->
        <div th:if="${successMessage}" class="alert alert-success">
            <svg class="alert-icon" xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 24 24">
                <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
            </svg>
            <span th:text="${successMessage}"></span>
        </div>

        <div th:if="${errorMessage}" class="alert alert-error">
            <svg class="alert-icon" xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 24 24">
                <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"/>
            </svg>
            <span th:text="${errorMessage}"></span>
        </div>

        <!-- New Loan Application Form -->
        <div class="loan-form-card">
            <div class="card-header">
                <h2 class="card-title">Apply for a New Loan</h2>
                <p class="card-description">Fill out the form below to submit your loan application</p>
            </div>

            <form th:action="@{/loans}" th:object="${loanRequest}" method="post" class="loan-form">

                <div class="form-grid">

                    <div class="form-group">
                        <label for="firstName" class="form-label">First Name</label>
                        <input type="text" th:field="*{firstName}" id="firstName"
                               class="form-input" placeholder="Enter your first name"
                               th:value="${customer.firstName}"
                               required/>
                    </div>

                    <div class="form-group">
                        <label for="lastName" class="form-label">Last Name</label>
                        <input type="text" th:field="*{lastName}" id="lastName"
                               class="form-input" placeholder="Enter your last name"
                               th:value="${customer.lastName}"
                               required/>
                    </div>

                    <div class="form-group">
                        <label for="loanType" class="form-label">Loan Type</label>
                        <select th:field="*{loanType}" id="loanType" class="form-select" required>
                            <option value="">Select loan type</option>
                            <option value="PERSONAL">Personal Loan (8.5% APR, 3 years)</option>
                            <option value="MORTGAGE">Mortgage (3.5% APR, 30 years)</option>
                            <option value="BUSINESS">Business Loan (6.5% APR, 5 years)</option>
                            <option value="STUDENT">Student Loan (4.5% APR, 10 years)</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="amount" class="form-label">Loan Amount (USD)</label>
                        <input type="number" th:field="*{amount}" id="amount"
                               class="form-input" placeholder="10000"
                               min="100" step="100" required/>
                    </div>
                </div>

                <div class="form-actions">
                    <button type="submit" class="btn btn-primary">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M9 16.17L4.83 12l-1.42 1.41L9 14.17l7.59-7.59L19 8l-9 9z"/>
                        </svg>
                        Submit Application
                    </button>
                    <button type="reset" class="btn btn-secondary">Clear Form</button>
                </div>
            </form>
        </div>

        <!-- Existing Loans Section -->
        <div class="loans-list-section" >
            <div class="section-header">
                <h2 class="section-title">Your Loan Applications</h2>
                <span class="loan-count" th:text="${loans != null ? loans.size() : 0} + ' Applications'">0 Applications</span>
            </div>

            <div th:if="${loans == null || loans.isEmpty()}" class="empty-state">
                <svg class="empty-icon" xmlns="http://www.w3.org/2000/svg" width="64" height="64" fill="currentColor" viewBox="0 0 24 24">
                    <path d="M20 6h-2.18c.11-.31.18-.65.18-1 0-1.66-1.34-3-3-3-1.05 0-1.96.54-2.5 1.35l-.5.67-.5-.68C10.96 2.54 10.05 2 9 2 7.34 2 6 3.34 6 5c0 .35.07.69.18 1H4c-1.11 0-1.99.89-1.99 2L2 19c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V8c0-1.11-.89-2-2-2zm-5-2c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm11 15H4v-2h16v2zm0-5H4V8h5.08L7 10.83 8.62 12 11 8.76l1-1.36 1 1.36L15.38 12 17 10.83 14.92 8H20v6z"/>
                </svg>
                <h3 class="empty-title">No Loan Applications Yet</h3>
                <p class="empty-description">Submit your first loan application using the form above</p>
            </div>

            <div th:if="${loans != null && !loans.isEmpty()}" class="loans-grid">
                <div th:each="loan : ${loans}" class="loan-card">
                    <div class="loan-card-header">
                        <div class="loan-type-badge" th:text="${loan.loanType}">PERSONAL</div>
                        <span class="loan-status"
                              th:classappend="${loan.loanStatus == 'APPROVED' ? 'status-approved' :
                                              loan.loanStatus == 'PENDING' ? 'status-pending' :
                                             loan.loanStatus == 'REJECTED' ? 'status-rejected' :
                                             loan.loanStatus == 'ACTIVE' ? 'status-active' : 'status-default'}"
                              th:text="${loan.loanStatus}">PENDING</span>
                    </div>

                    <div class="loan-amount-section">
                        <p class="amount-label">Loan Amount</p>
                        <h3 class="amount-value" th:text="'$' + ${#numbers.formatDecimal(loan.amount, 1, 2)}"></h3>
                    </div>

                    <div class="loan-details-grid">
                        <div class="detail-item">
                            <span class="detail-label">Interest Rate</span>
                            <span class="detail-value" th:text="${loan.interestRate} + '%'"></span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Monthly Payment</span>
                            <span class="detail-value" th:text="'$' + ${#numbers.formatDecimal(loan.monthlyPayment, 1, 2)}"></span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Term</span>
                            <span class="detail-value" th:text="${loan.termMonths} + ' months'">36 months</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Applied On</span>
                            <span class="detail-value" th:text="${#temporals.format(loan.createdOn, 'MMM dd, yyyy', T(java.util.Locale).ENGLISH)}"></span>
                        </div>
                    </div>

                    <div class="loan-card-actions">
                        <a th:href="@{/loans/edit/{loanId}(loanId=${loan.loanId})}" class="btn-action btn-edit">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"/>
                            </svg>
                            Edit
                        </a>
                        <form th:action="@{/loans/delete/{loanId}(loanId=${loan.loanId})}" method="post" style="display: inline;">
                            <button type="submit" class="btn-action btn-delete" onclick="return confirm('Are you sure you want to delete this loan application?');">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 24 24">
                                    <path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/>
                                </svg>
                                Delete
                            </button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
</main>

<th:block th:insert="~{fragments/footer :: footer}"></th:block>
</body>
</html>
